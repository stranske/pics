<svg width="1200" height="1200" viewBox="-20 -20 1240 1240"
         xmlns="http://www.w3.org/2000/svg"
         xmlns:xlink="http://www.w3.org/1999/xlink">

      <!-- Arrowhead definition -->
      <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="10"
                refX="5" refY="5" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L10,5 L0,10 Z" fill="#003f6b" />
        </marker>
      </defs>

      <!-- ================= ROOT NODE ================= -->
      <g class="node-group" data-node-id="root-root">
        <a xlink:href="#chart">
          <ellipse cx="600" cy="600" rx="80" ry="40"
                   fill="#B3D1FF" stroke="#003f6b" stroke-width="3" />
        </a>
        <text x="600" y="600" text-anchor="middle"
              font-size="16px" font-weight="bold" fill="#003f6b"
              dominant-baseline="middle" class="small-root-text">
          Stuck With LLM
        </text>
      </g>

      <!-- ============== MAIN CATEGORY NODES ============== -->
      <!-- Mains at R_main = 275 px, 10 angles (36° increments) -->

      <!-- 1) Clarity (90°) -->
      <g class="node-group" data-node-id="main-1">
        <a xlink:href="#lib-1">
          <rect x="530.000" y="300.000" width="140" height="50" rx="8" ry="8"
                fill="#D9EFFF" stroke="#005B96" stroke-width="2" />
        </a>
        <text x="600.000" y="320.000" text-anchor="middle"
              font-size="12px" font-weight="bold" fill="#003f6b" class="small-main-text">
          Clarity
        </text>
        <text x="600.000" y="334.000" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-main-text">
          (Vague / Ambiguous)
        </text>
      </g>

      <!-- 2) Repetition (54°) -->
      <g class="node-group" data-node-id="main-2">
        <a xlink:href="#lib-2">
          <rect x="691.640" y="350.020" width="140" height="50" rx="8" ry="8"
                fill="#D9EFFF" stroke="#005B96" stroke-width="2" />
        </a>
        <text x="761.641" y="370.020" text-anchor="middle"
              font-size="12px" font-weight="bold" fill="#003f6b" class="small-main-text">
          Repetition
        </text>
        <text x="761.641" y="384.020" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-main-text">
          (Looping)
        </text>
      </g>

      <!-- 3) Bloat (18°) -->
      <g class="node-group" data-node-id="main-3">
        <a xlink:href="#lib-3">
          <rect x="821.540" y="490.020" width="140" height="50" rx="8" ry="8"
                fill="#D9EFFF" stroke="#005B96" stroke-width="2" />
        </a>
        <text x="861.541" y="510.020" text-anchor="middle"
              font-size="12px" font-weight="bold" fill="#003f6b" class="small-main-text">
          Bloat
        </text>
        <text x="861.541" y="524.020" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-main-text">
          (Too Long / Off-Topic)
        </text>
      </g>

      <!-- 4) Misinterpretation (−18°) -->
      <g class="node-group" data-node-id="main-4">
        <a xlink:href="#lib-4">
          <rect x="821.540" y="662.480" width="140" height="50" rx="8" ry="8"
                fill="#D9EFFF" stroke="#005B96" stroke-width="2" />
        </a>
        <text x="861.541" y="682.480" text-anchor="middle"
              font-size="12px" font-weight="bold" fill="#003f6b" class="small-main-text">
          Misinterpretation
        </text>
        <text x="861.541" y="696.480" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-main-text">
          (Wrong Assumptions)
        </text>
      </g>

      <!-- 5) Planning (−54°) -->
      <g class="node-group" data-node-id="main-5">
        <a xlink:href="#lib-5">
          <rect x="691.640" y="787.480" width="140" height="50" rx="8" ry="8"
                fill="#D9EFFF" stroke="#005B96" stroke-width="2" />
        </a>
        <text x="761.641" y="807.480" text-anchor="middle"
              font-size="12px" font-weight="bold" fill="#003f6b" class="small-main-text">
          Planning
        </text>
        <text x="761.641" y="821.480" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-main-text">
          (Need Steps)
        </text>
      </g>

      <!-- 6) Validation (−90°) -->
      <g class="node-group" data-node-id="main-6">
        <a xlink:href="#lib-6">
          <rect x="530.000" y="850.000" width="140" height="50" rx="8" ry="8"
                fill="#D9EFFF" stroke="#005B96" stroke-width="2" />
        </a>
        <text x="600.000" y="870.000" text-anchor="middle"
              font-size="12px" font-weight="bold" fill="#003f6b" class="small-main-text">
          Validation
        </text>
        <text x="600.000" y="884.000" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-main-text">
          (Need Tests)
        </text>
      </g>

      <!-- 7) Edge Cases (−126°) -->
      <g class="node-group" data-node-id="main-7">
        <a xlink:href="#lib-7">
          <rect x="368.359" y="787.480" width="140" height="50" rx="8" ry="8"
                fill="#D9EFFF" stroke="#005B96" stroke-width="2" />
        </a>
        <text x="438.359" y="807.480" text-anchor="middle"
              font-size="12px" font-weight="bold" fill="#003f6b" class="small-main-text">
          Edge Cases
        </text>
        <text x="438.359" y="821.480" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-main-text">
          (Robustness)
        </text>
      </g>

      <!-- 8) Diff/Patch (−162°) -->
      <g class="node-group" data-node-id="main-8">
        <a xlink:href="#lib-8">
          <rect x="268.459" y="662.480" width="140" height="50" rx="8" ry="8"
                fill="#D9EFFF" stroke="#005B96" stroke-width="2" />
        </a>
        <text x="338.459" y="682.480" text-anchor="middle"
              font-size="12px" font-weight="bold" fill="#003f6b" class="small-main-text">
          Diff/Patch
        </text>
        <text x="338.459" y="696.480" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-main-text">
          (Precise Changes)
        </text>
      </g>

      <!-- 9) Reframing (−198°) -->
      <g class="node-group" data-node-id="main-9">
        <a xlink:href="#lib-9">
          <rect x="268.459" y="490.020" width="140" height="50" rx="8" ry="8"
                fill="#D9EFFF" stroke="#005B96" stroke-width="2" />
        </a>
        <text x="338.459" y="510.020" text-anchor="middle"
              font-size="12px" font-weight="bold" fill="#003f6b" class="small-main-text">
          Reframing
        </text>
        <text x="338.459" y="524.020" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-main-text">
          (New Angle)
        </text>
      </g>

      <!-- 10) Next Prompt (−234°) -->
      <g class="node-group" data-node-id="main-10">
        <a xlink:href="#lib-10">
          <rect x="368.359" y="350.020" width="140" height="50" rx="8" ry="8"
                fill="#D9EFFF" stroke="#005B96" stroke-width="2" />
        </a>
        <text x="438.359" y="370.020" text-anchor="middle"
              font-size="12px" font-weight="bold" fill="#003f6b" class="small-main-text">
          Next Prompt
        </text>
        <text x="438.359" y="384.020" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-main-text">
          (Meta-Help)
        </text>
      </g>

      <!-- =============== SUB‐BRANCH NODES (Single‐Ring, R_sub=605) =============== -->

      <!-- sub-1a: Ask Clarifiers -->
      <g class="node-group" data-node-id="sub-1a">
        <a xlink:href="#lib-1a">
          <rect x="786.076" y="27.305" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="846.076" y="47.305" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Ask Clarifiers
        </text>
      </g>

      <!-- sub-1b: Restate Request -->
      <g class="node-group" data-node-id="sub-1b">
        <a xlink:href="#lib-1b">
          <rect x="540.000" y="-25.000" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="600.000" y=" -5.000" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Restate Request
        </text>
      </g>

      <!-- sub-1c: Surface Assumptions -->
      <g class="node-group" data-node-id="sub-1c">
        <a xlink:href="#lib-1c">
          <rect x="293.924" y="27.305" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="353.924" y="47.305" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Surface Assumptions
        </text>
      </g>

      <!-- sub-2a: Alternative Approaches -->
      <g class="node-group" data-node-id="sub-2a">
        <a xlink:href="#lib-2a">
          <rect x="1063.945" y="277.500" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="1123.945" y="297.500" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Alternative Approaches
        </text>
      </g>

      <!-- sub-2b: Contradict Yourself -->
      <g class="node-group" data-node-id="sub-2b">
        <a xlink:href="#lib-2b">
          <rect x="895.610" y="90.545" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="955.610" y="110.545" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Contradict Yourself
        </text>
      </g>

      <!-- sub-2c: Decision Matrix -->
      <g class="node-group" data-node-id="sub-2c">
        <a xlink:href="#lib-2c">
          <rect x="665.787" y="-11.779" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="725.787" y="8.221" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Decision Matrix
        </text>
      </g>

      <!-- sub-3a: Conciseness -->
      <g class="node-group" data-node-id="sub-3a">
        <a xlink:href="#lib-3a">
          <rect x="1141.686" y="643.240" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="1201.686" y="663.240" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Conciseness
        </text>
      </g>

      <!-- sub-3b: Focus Topic -->
      <g class="node-group" data-node-id="sub-3b">
        <a xlink:href="#lib-3b">
          <rect x="1115.389" y="393.045" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="1175.389" y="413.045" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Focus Topic
        </text>
      </g>

      <!-- sub-3c: Trim Output -->
      <g class="node-group" data-node-id="sub-3c">
        <a xlink:href="#lib-3c">
          <rect x="989.603" y="175.176" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="1049.603" y="195.176" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Trim Output
        </text>
      </g>

      <!-- sub-4a: Check Assumptions -->
      <g class="node-group" data-node-id="sub-4a">
        <a xlink:href="#lib-4a">
          <rect x="989.603" y="984.824" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="1049.603" y="1004.824" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Check Assumptions
        </text>
      </g>

      <!-- sub-4b: Reframe Context -->
      <g class="node-group" data-node-id="sub-4b">
        <a xlink:href="#lib-4b">
          <rect x="1115.389" y="766.955" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="1175.389" y="786.955" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Reframe Context
        </text>
      </g>

      <!-- sub-4c: Domain Specification -->
      <g class="node-group" data-node-id="sub-4c">
        <a xlink:href="#lib-4c">
          <rect x="1141.686" y="516.760" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="1201.686" y="536.760" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Domain Specification
        </text>
      </g>

      <!-- sub-5a: Step-by-Step Outline -->
      <g class="node-group" data-node-id="sub-5a">
        <a xlink:href="#lib-5a">
          <rect x="665.787" y="1171.779" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="725.787" y="1191.779" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Step-by-Step Outline
        </text>
      </g>

      <!-- sub-5b: Sequential Queries -->
      <g class="node-group" data-node-id="sub-5b">
        <a xlink:href="#lib-5b">
          <rect x="895.610" y="1069.455" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="955.610" y="1089.455" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Sequential Queries
        </text>
      </g>

      <!-- sub-5c: Divide & Conquer -->
      <g class="node-group" data-node-id="sub-5c">
        <a xlink:href="#lib-5c">
          <rect x="1063.945" y="882.500" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="1123.945" y="902.500" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Divide &amp; Conquer
        </text>
      </g>

      <!-- sub-6a: Sanity Check -->
      <g class="node-group" data-node-id="sub-6a">
        <a xlink:href="#lib-6a">
          <rect x="293.924" y="1132.695" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="353.924" y="1152.695" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Sanity Check
        </text>
      </g>

      <!-- sub-6b: Generate Test Cases -->
      <g class="node-group" data-node-id="sub-6b">
        <a xlink:href="#lib-6b">
          <rect x="540.000" y="1185.000" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="600.000" y="1205.000" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Generate Test Cases
        </text>
      </g>

      <!-- sub-6c: Verify Calculations -->
      <g class="node-group" data-node-id="sub-6c">
        <a xlink:href="#lib-6c">
          <rect x="786.076" y="1132.695" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="846.076" y="1152.695" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Verify Calculations
        </text>
      </g>

      <!-- sub-7a: Edge Cases -->
      <g class="node-group" data-node-id="sub-7a">
        <a xlink:href="#lib-7a">
          <rect x="16.055" y="882.500" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="76.055" y="902.500" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Edge Cases
        </text>
      </g>

      <!-- sub-7b: Robustness Testing -->
      <g class="node-group" data-node-id="sub-7b">
        <a xlink:href="#lib-7b">
          <rect x="184.390" y="1069.455" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="244.390" y="1089.455" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Robustness Testing
        </text>
      </g>

      <!-- sub-7c: Alternative Scenarios -->
      <g class="node-group" data-node-id="sub-7c">
        <a xlink:href="#lib-7c">
          <rect x="414.213" y="1171.779" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="474.213" y="1191.779" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Alternative Scenarios
        </text>
      </g>

      <!-- sub-8a: Show Diffs -->
      <g class="node-group" data-node-id="sub-8a">
        <a xlink:href="#lib-8a">
          <rect x="-61.686" y="516.760" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x=" -1.686" y="536.760" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Show Diffs
        </text>
      </g>

      <!-- sub-8b: Patch Instructions -->
      <g class="node-group" data-node-id="sub-8b">
        <a xlink:href="#lib-8b">
          <rect x="-35.389" y="766.955" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x=" 24.611" y="786.955" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Patch Instructions
        </text>
      </g>

      <!-- sub-8c: Precise Edits -->
      <g class="node-group" data-node-id="sub-8c">
        <a xlink:href="#lib-8c">
          <rect x="90.397" y="984.824" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="150.397" y="1004.824" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Precise Edits
        </text>
      </g>

      <!-- sub-9a: New Angle -->
      <g class="node-group" data-node-id="sub-9a">
        <a xlink:href="#lib-9a">
          <rect x="90.397" y="175.176" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="150.397" y="195.176" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          New Angle
        </text>
      </g>

      <!-- sub-9b: Analogies -->
      <g class="node-group" data-node-id="sub-9b">
        <a xlink:href="#lib-9b">
          <rect x="-35.389" y="393.045" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x=" 24.611" y="413.045" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Analogies
        </text>
      </g>

      <!-- sub-9c: Perspective Shift -->
      <g class="node-group" data-node-id="sub-9c">
        <a xlink:href="#lib-9c">
          <rect x="-61.686" y="643.240" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x=" -1.686" y="663.240" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Perspective Shift
        </text>
      </g>

      <!-- sub-10a: Meta Prompt -->
      <g class="node-group" data-node-id="sub-10a">
        <a xlink:href="#lib-10a">
          <rect x="414.213" y="-11.779" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="474.213" y=" 8.221" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Meta Prompt
        </text>
      </g>

      <!-- sub-10b: System Check -->
      <g class="node-group" data-node-id="sub-10b">
        <a xlink:href="#lib-10b">
          <rect x="184.390" y="90.545" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x="244.390" y="110.545" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          System Check
        </text>
      </g>

      <!-- sub-10c: Agent Self-Review -->
      <g class="node-group" data-node-id="sub-10c">
        <a xlink:href="#lib-10c">
          <rect x="16.055" y="277.500" width="120" height="40" rx="10" ry="10"
                fill="#E8F4FC" stroke="#0072B1" stroke-width="2" class="sub-rect" />
        </a>
        <text x=" 76.055" y="297.500" text-anchor="middle"
              font-size="10px" fill="#003f6b" class="small-sub-text">
          Agent Self-Review
        </text>
      </g>

      <!-- =============== CURVED ARROWS (Root→Main, Main→Sub) =============== -->
      <g class="overlay">
        <!-- Root→Main arrows (control radius=137.5) -->
        <!-- 1) → Clarity -->
        <path class="link" data-parent-id="root-root"
              d="M600,600 Q600,462.500 600,325"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="600" cy="325" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- 2) → Repetition -->
        <path class="link" data-parent-id="root-root"
              d="M600,600 Q669.529,525.178 761.641,377.520"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="761.641" cy="377.520" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- 3) → Bloat -->
        <path class="link" data-parent-id="root-root"
              d="M600,600 Q675.825,574.525 861.541,515.020"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="861.541" cy="515.020" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- 4) → Misinterpretation -->
        <path class="link" data-parent-id="root-root"
              d="M600,600 Q700.825,625.475 861.541,684.980"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="861.541" cy="684.980" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- 5) → Planning -->
        <path class="link" data-parent-id="root-root"
              d="M600,600 Q525.175,700.475 761.641,822.480"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="761.641" cy="822.480" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- 6) → Validation -->
        <path class="link" data-parent-id="root-root"
              d="M600,600 Q600,731.250 600,875"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="600" cy="875" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- 7) → Edge Cases -->
        <path class="link" data-parent-id="root-root"
              d="M600,600 Q525.175,700.475 438.359,822.480"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="438.359" cy="822.480" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- 8) → Diff/Patch -->
        <path class="link" data-parent-id="root-root"
              d="M600,600 Q474.175,625.475 338.459,684.980"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="338.459" cy="684.980" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- 9) → Reframing -->
        <path class="link" data-parent-id="root-root"
              d="M600,600 Q474.175,574.525 338.459,515.020"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="338.459" cy="515.020" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- 10) → Next Prompt -->
        <path class="link" data-parent-id="root-root"
              d="M600,600 Q525.175,525.475 438.359,377.520"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="438.359" cy="377.520" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- ========== MAIN→SUB ARROWS (R_ctrl = 440 px) ========== -->
        <!-- Cluster 1 (θ=90°): R_ctrl=440 -->
        <path class="link" data-parent-id="main-1"
              d="M600.000,325.000 Q588.179,285.712 846.076,47.305"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="846.076" cy="47.305" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-1"
              d="M600.000,325.000 Q600.000, - ?  600.000, -? ?"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <!-- Note: For sub-1b, the Q‐point is at φ=90°, so Q = (600 + 440·cos(90°), 600 - 440·sin(90°)) = (600, 160). Then end = (600,  - 5). -->
        <path class="link" data-parent-id="main-1"
              d="M600.000,325.000 Q600.000,160.000 600.000, -5.000"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="600.000" cy="-5.000" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-1"
              d="M600.000,325.000 Q611.821,285.712 353.924,47.305"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="353.924" cy="47.305" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- Cluster 2 (θ=54°): R_ctrl=440 -->
        <path class="link" data-parent-id="main-2"
              d="M761.641,377.520 Q722.825,330.692 1123.945,297.500"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="1123.945" cy="297.500" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-2"
              d="M761.641,377.520 Q778.526,294.072 955.610,110.545"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="955.610" cy="110.545" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-2"
              d="M761.641,377.520 Q814.725,343.878 725.787,8.221"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="725.787" cy="8.221" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- Cluster 3 (θ=18°): R_ctrl=440 -->
        <path class="link" data-parent-id="main-3"
              d="M861.541,515.020 Q919.212,454.539 1201.686,663.240"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="1201.686" cy="663.240" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-3"
              d="M861.541,515.020 Q919.212,454.539 1175.389,413.045"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="1175.389" cy="413.045" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-3"
              d="M861.541,515.020 Q919.212,454.539 1049.603,195.176"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="1049.603" cy="195.176" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- Cluster 4 (θ=−18°): R_ctrl=440 -->
        <path class="link" data-parent-id="main-4"
              d="M861.541,684.980 Q803.684,631.095 1049.603,1024.824"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="1049.603" cy="1024.824" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-4"
              d="M861.541,684.980 Q803.684,631.095 1175.389,806.955"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="1175.389" cy="806.955" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-4"
              d="M861.541,684.980 Q803.684,631.095 1201.686,556.760"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="1201.686" cy="556.760" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- Cluster 5 (θ=−54°): R_ctrl=440 -->
        <path class="link" data-parent-id="main-5"
              d="M761.641,822.480 Q697.518,775.220 725.787,1191.779"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="725.787" cy="1191.779" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-5"
              d="M761.641,822.480 Q697.518,775.220 955.610,1089.455"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="955.610" cy="1089.455" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-5"
              d="M761.641,822.480 Q697.518,775.220 1123.945,902.500"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="1123.945" cy="902.500" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- Cluster 6 (θ=−90°): R_ctrl=440 -->
        <path class="link" data-parent-id="main-6"
              d="M600.000,875.000 Q600.000,712.000 353.924,1152.695"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="353.924" cy="1152.695" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-6"
              d="M600.000,875.000 Q600.000,712.000 600.000,1205.000"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="600.000" cy="1205.000" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-6"
              d="M600.000,875.000 Q600.000,712.000 846.076,1152.695"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="846.076" cy="1152.695" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- Cluster 7 (θ=−126°): R_ctrl=440 -->
        <path class="link" data-parent-id="main-7"
              d="M438.359,822.480 Q438.359,594.887 76.055,902.500"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="76.055" cy="902.500" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-7"
              d="M438.359,822.480 Q438.359,594.887 244.390,1089.455"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="244.390" cy="1089.455" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-7"
              d="M438.359,822.480 Q438.359,594.887 474.213,1191.779"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="474.213" cy="1191.779" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- Cluster 8 (θ=−162°): R_ctrl=440 -->
        <path class="link" data-parent-id="main-8"
              d="M338.459,684.980 Q338.459,427.880  -1.686,556.760"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="-1.686" cy="556.760" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-8"
              d="M338.459,684.980 Q338.459,427.880  24.611,806.955"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="24.611" cy="806.955" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-8"
              d="M338.459,684.980 Q338.459,427.880 150.397,1024.824"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="150.397" cy="1024.824" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- Cluster 9 (θ=−198°): R_ctrl=440 -->
        <path class="link" data-parent-id="main-9"
              d="M338.459,515.020 Q338.459,299.593 150.397,215.176"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="150.397" cy="215.176" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-9"
              d="M338.459,515.020 Q338.459,299.593  24.611,433.045"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="24.611" cy="433.045" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-9"
              d="M338.459,515.020 Q338.459,299.593  -1.686,683.240"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="-1.686" cy="683.240" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <!-- Cluster 10 (θ=−234°): R_ctrl=440 -->
        <path class="link" data-parent-id="main-10"
              d="M438.359,377.520 Q438.359,132.158 474.213,8.221"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="474.213" cy="8.221" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-10"
              d="M438.359,377.520 Q438.359,132.158 244.390,110.545"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="244.390" cy="110.545" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />

        <path class="link" data-parent-id="main-10"
              d="M438.359,377.520 Q438.359,132.158  76.055,297.500"
              fill="none" stroke="#003f6b" stroke-width="2"
              marker-end="url(#arrowhead)" />
        <circle cx="76.055" cy="297.500" r="4" fill="#F1F1F1" stroke="#FFFFFF" stroke-width="1" />
      </g>

      <!-- =============== PINNED LEGEND =============== -->
      <foreignObject x="0" y="0" width="1200" height="1200">
        <div xmlns="http://www.w3.org/1999/xhtml"
             style="position:absolute; right:20px; bottom:20px; width:180px; height:80px;"
             class="legend-container">
          <svg width="180" height="80">
            <!-- Root swatch -->
            <ellipse cx="12" cy="12" rx="12" ry="6"
                     fill="#B3D1FF" stroke="#003f6b" stroke-width="2" />
            <text x="32" y="16" fill="#333" font-size="9px">Root</text>
            <!-- Main swatch -->
            <rect x="0" y="32" width="24" height="24" rx="4" ry="4"
                  fill="#D9EFFF" stroke="#005B96" stroke-width="2" />
            <text x="32" y="50" fill="#333" font-size="9px">Main</text>
            <!-- Sub swatch -->
            <rect x="0" y="60" width="24" height="16" rx="4" ry="4"
                  fill="#E8F4FC" stroke="#0072B1" stroke-width="2" />
            <text x="32" y="74" fill="#333" font-size="9px">Sub</text>
            <title>Legend: Root = large ellipse; Main = mid rectangle; Sub = small rounded</title>
          </svg>
        </div>
      </foreignObject>

    </svg>
